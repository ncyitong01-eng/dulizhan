<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼”ç¤ºé¢„è§ˆ - äº§å“æ ¸ä»·ç³»ç»Ÿ</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --bg: #f8f9fa; }
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background: var(--bg); padding: 20px; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .flex-layout { display: flex; gap: 30px; flex-wrap: wrap; }
        .calc-panel { flex: 1; min-width: 300px; }
        .preview-panel { width: 300px; text-align: center; background: #fff; padding: 15px; border: 1px dashed #ddd; border-radius: 10px; }
        .section { margin-bottom: 25px; padding: 20px; border-radius: 10px; border: 1px solid #eee; }
        h2 { font-size: 1.2em; color: var(--primary); margin-top: 0; border-left: 4px solid var(--accent); padding-left: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        label { display: block; font-size: 0.85em; font-weight: bold; margin-bottom: 5px; }
        select, input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
        .result-box { background: #f0f7ff; padding: 15px; border-radius: 8px; margin-top: 15px; color: #004085; }
        #product-img { max-width: 100%; height: auto; border-radius: 8px; margin-top: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .comp-row { display: flex; gap: 10px; margin-bottom: 8px; }
        .btn-add { background: var(--accent); color: white; border: none; padding: 5px 12px; border-radius: 4px; cursor: pointer; font-size: 0.8em; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center;">ç‹¬ç«‹ç«™äº§å“æ ¸ä»·ç³»ç»Ÿ</h1>

    <div class="flex-layout">
        <div class="calc-panel">
            
            <div class="section">
                <h2>ğŸ”˜ æŒ‰é’®å¾½ç«  (Badges)</h2>
                <div class="grid">
                    <div>
                        <label>é€‰æ‹©å½¢çŠ¶/å·¥è‰º</label>
                        <select id="bType" onchange="syncBadgeOptions()">
                            <optgroup label="å¸¸è§„ç³»åˆ— (1.5x)">
                                <option value="normal_round">å¸¸è§„åœ†å½¢</option>
                            </optgroup>
                            <optgroup label="åŒé—ªç³»åˆ— (1.3x)">
                                <option value="flash_standard">åŒé—ª-æ ‡å‡†å½¢</option>
                                <option value="flash_special">åŒé—ª-å¤§å·/å¼‚å½¢</option>
                            </optgroup>
                        </select>
                    </div>
                    <div>
                        <label>å…·ä½“å°ºå¯¸</label>
                        <select id="bSize" onchange="updateBadgeUI()"></select>
                    </div>
                    <div>
                        <label>æ•°é‡</label>
                        <input type="number" id="bQty" value="100" oninput="calcAll()">
                    </div>
                    <div id="lamWrap">
                        <label>è¦†è†œ (å¸¸è§„æ¬¾å¯ç”¨)</label>
                        <select id="bLam">
                            <option value="0">å…¨å·¥è‰ºä¸åŠ è´¹</option>
                        </select>
                    </div>
                </div>
                <div class="result-box">
                    ç¾å…ƒå•ä»·: <strong>$<span id="bUnit">0.00</span></strong> | æ€»è®¡: <strong>$<span id="bTotal">0.00</span></strong>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ§© äºšå…‹åŠ›ç«‹ç‰Œ (Stands)</h2>
                <div id="standList">
                    <div class="comp-row">
                        <input type="number" class="sL" placeholder="é•¿(cm)" value="5" oninput="calcAll()">
                        <input type="number" class="sW" placeholder="å®½(cm)" value="5" oninput="calcAll()">
                    </div>
                </div>
                <button class="btn-add" onclick="addStandRow()">+ å¢åŠ ç»„ä»¶</button>
                <div style="margin-top:15px;">
                    <label>è®¢å•æ€»æ•°</label>
                    <input type="number" id="sQty" value="200" oninput="calcAll()">
                </div>
                <div class="result-box">
                    å•å¥—ç¾å…ƒ: <strong>$<span id="sUnit">0.00</span></strong> | æ€»è®¡: <strong>$<span id="sTotal">0.00</span></strong>
                </div>
            </div>

        </div>

        <div class="preview-panel">
            <label style="color:#888">äº§å“é¢„è§ˆ (Product Preview)</label>
            <img id="product-img" src="changguibaji.jpg" alt="é¢„è§ˆå›¾">
            <p id="img-note" style="font-size: 0.8em; color: #666; margin-top: 10px;"></p>
        </div>
    </div>
</div>

<script>
// --- é…ç½®åº“ ---
const bData = {
    normal_round: {
        premium: 1.5,
        img: "changguibaji.jpg",
        sizes: { "25-58mm": [1.0, 0.95, 0.9, 0.8, 0.7, 0.67, 0.65], "65-75mm/å°é•¿æ–¹": [2.0, 1.8, 1.6, 1.5, 1.4, 1.3, 1.2] }
    },
    flash_standard: {
        premium: 1.3,
        img: "shuangshanbaji.jpg",
        sizes: { 
            "25-58mmåœ†å½¢": [1.0, 0.95, 0.9, 0.8, 0.7, 0.67, 0.65], 
            "é•¿æ–¹å½¢ (70*43/30*85)": [3.5, 3.2, 2.9, 2.7, 2.3, 2.1, 2.0],
            "æ­£æ–¹å½¢ (50*50)": [3.5, 3.2, 2.9, 2.7, 2.3, 2.1, 2.0],
            "å°æ¤­åœ† (45*65)": [3.5, 3.2, 2.9, 2.7, 2.3, 2.1, 2.0],
            "è±å½¢ (65*60)": [3.5, 3.2, 2.9, 2.7, 2.3, 2.1, 2.0]
        },
        imgMap: { "é•¿æ–¹å½¢": "changfangxinbaji.jpg", "æ­£æ–¹å½¢": "zhengfangxingbaji.webp", "å°æ¤­åœ†": "datuoyuanbaji.jpg" }
    },
    flash_special: {
        premium: 1.3,
        img: "datuoyuanbaji.jpg",
        sizes: { 
            "å¤§æ¤­åœ† (93*63)": [5.0, 3.7, 3.5, 3.3, 3.0, 2.9, 2.8],
            "æ£ºæå½¢ (77*47)": [5.0, 3.7, 3.5, 3.3, 3.0, 2.9, 2.8],
            "é’»çŸ³å½¢ (73*61)": [5.0, 3.7, 3.5, 3.3, 3.0, 2.9, 2.8],
            "å¿ƒå½¢ (60*50)": [5.0, 3.7, 3.5, 3.3, 3.0, 2.9, 2.8],
            "çŒ«è€³ (58*57)": [5.0, 3.7, 3.5, 3.3, 3.0, 2.9, 2.8]
        },
        imgMap: { "æ£ºæ": "guancaibaji.webp", "é’»çŸ³": "zuanshibaji.webp", "å¿ƒå½¢": "aixinbaji.webp", "çŒ«è€³": "maotoubaji.webp" }
    }
};

// --- åˆå§‹åŒ–ä¸åŒæ­¥ ---
function syncBadgeOptions() {
    const type = document.getElementById('bType').value;
    const sizeSelect = document.getElementById('bSize');
    sizeSelect.innerHTML = "";
    Object.keys(bData[type].sizes).forEach(s => sizeSelect.options.add(new Option(s, s)));
    document.getElementById('lamWrap').style.display = (type === 'normal_round') ? 'block' : 'none';
    updateBadgeUI();
}

function updateBadgeUI() {
    const type = document.getElementById('bType').value;
    const sizeText = document.getElementById('bSize').value;
    const imgEl = document.getElementById('product-img');
    
    // è‡ªåŠ¨åˆ‡æ¢å›¾ç‰‡é€»è¾‘
    let activeImg = bData[type].img;
    if(bData[type].imgMap) {
        for(let key in bData[type].imgMap) {
            if(sizeText.includes(key)) activeImg = bData[type].imgMap[key];
        }
    }
    imgEl.src = activeImg;
    document.getElementById('img-note').innerText = "å½“å‰å±•ç¤º: " + sizeText;
    calcAll();
}

// --- æ ¸å¿ƒè®¡ç®—é€»è¾‘ ---
function calcAll() {
    // 1. å§å”§è®¡ç®—
    const bType = document.getElementById('bType').value;
    const bSize = document.getElementById('bSize').value;
    const bQty = parseInt(document.getElementById('bQty').value) || 0;
    const pList = bData[bType].sizes[bSize];
    let rmb = 0;
    if (bQty >= 3000) rmb = pList[6];
    else if (bQty >= 2000) rmb = pList[5];
    else if (bQty >= 600) rmb = pList[4];
    else if (bQty >= 300) rmb = pList[3];
    else if (bQty >= 100) rmb = pList[2];
    else if (bQty >= 10) rmb = pList[1];
    else rmb = pList[0];

    let bUnit = (rmb * bData[bType].premium) / 7;
    document.getElementById('bUnit').innerText = bUnit.toFixed(2);
    document.getElementById('bTotal').innerText = (bUnit * bQty).toFixed(2);

    // 2. ç«‹ç‰Œè®¡ç®—
    const sQty = parseInt(document.getElementById('sQty').value) || 0;
    let factor1 = 0.05;
    if (sQty >= 3000) factor1 = 0.025;
    else if (sQty >= 2000) factor1 = 0.028;
    else if (sQty >= 1000) factor1 = 0.03;
    else if (sQty >= 500) factor1 = 0.035;
    else if (sQty >= 200) factor1 = 0.04;
    else if (sQty >= 100) factor1 = 0.045;

    let sTotalRMB = 0;
    document.querySelectorAll('#standList .comp-row').forEach(row => {
        let l = parseFloat(row.querySelector('.sL').value) || 0;
        let w = parseFloat(row.querySelector('.sW').value) || 0;
        let area = sQty >= 200 ? (l + 0.5) * (w + 0.5) : l * w;
        sTotalRMB += (area * factor1 * 1.5);
    });
    
    let sUnitUSD = sTotalRMB / 7;
    document.getElementById('sUnit').innerText = sUnitUSD.toFixed(2);
    document.getElementById('sTotal').innerText = (sUnitUSD * sQty).toFixed(2);
}

function addStandRow() {
    const div = document.createElement('div');
    div.className = 'comp-row';
    div.innerHTML = `<input type="number" class="sL" placeholder="é•¿(cm)" value="5" oninput="calcAll()">
                     <input type="number" class="sW" placeholder="å®½(cm)" value="5" oninput="calcAll()">`;
    document.getElementById('standList').appendChild(div);
    calcAll();
}

// é¡µé¢åŠ è½½åç«‹å³è¿è¡Œä¸€æ¬¡
window.onload = syncBadgeOptions;
</script>

</body>
</html>
